!function(a,b){"object"==typeof exports&&exports?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.Mustache={})}(this,function(a){function b(a){return"function"==typeof a}function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function d(a,b){return o.call(a,b)}function e(a){return!d(p,a)}function f(a){return String(a).replace(/[&<>"'\/]/g,function(a){return q[a]})}function g(b,d){function f(){if(w&&!x)for(;q.length;)delete p[q.pop()];else q=[];w=!1,x=!1}function g(a){if("string"==typeof a&&(a=a.split(s,2)),!n(a)||2!==a.length)throw new Error("Invalid tags: "+a);k=new RegExp(c(a[0])+"\\s*"),l=new RegExp("\\s*"+c(a[1])),m=new RegExp("\\s*"+c("}"+a[1]))}if(!b)return[];var k,l,m,o=[],p=[],q=[],w=!1,x=!1;g(d||a.tags);for(var y,z,A,B,C,D,E=new j(b);!E.eos();){if(y=E.pos,A=E.scanUntil(k))for(var F=0,G=A.length;G>F;++F)B=A.charAt(F),e(B)?q.push(p.length):x=!0,p.push(["text",B,y,y+1]),y+=1,"\n"===B&&f();if(!E.scan(k))break;if(w=!0,z=E.scan(v)||"name",E.scan(r),"="===z?(A=E.scanUntil(t),E.scan(t),E.scanUntil(l)):"{"===z?(A=E.scanUntil(m),E.scan(u),E.scanUntil(l),z="&"):A=E.scanUntil(l),!E.scan(l))throw new Error("Unclosed tag at "+E.pos);if(C=[z,A,y,E.pos],p.push(C),"#"===z||"^"===z)o.push(C);else if("/"===z){if(D=o.pop(),!D)throw new Error('Unopened section "'+A+'" at '+y);if(D[1]!==A)throw new Error('Unclosed section "'+D[1]+'" at '+y)}else"name"===z||"{"===z||"&"===z?x=!0:"="===z&&g(A)}if(D=o.pop())throw new Error('Unclosed section "'+D[1]+'" at '+E.pos);return i(h(p))}function h(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function i(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;h>g;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function j(a){this.string=a,this.tail=a,this.pos=0}function k(a,b){this.view=null==a?{}:a,this.cache={".":this.view},this.parent=b}function l(){this.cache={}}var m=Object.prototype.toString,n=Array.isArray||function(a){return"[object Array]"===m.call(a)},o=RegExp.prototype.test,p=/\S/,q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},r=/\s*/,s=/\s+/,t=/\s*=/,u=/\s*\}/,v=/#|\^|\/|>|\{|&|=|!/;j.prototype.eos=function(){return""===this.tail},j.prototype.scan=function(a){var b=this.tail.match(a);if(!b||0!==b.index)return"";var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c},j.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},k.prototype.push=function(a){return new k(a,this)},k.prototype.lookup=function(a){var c,d=this.cache;if(a in d)c=d[a];else{for(var e,f,g=this;g;){if(a.indexOf(".")>0)for(c=g.view,e=a.split("."),f=0;null!=c&&f<e.length;)c=c[e[f++]];else c=g.view[a];if(null!=c)break;g=g.parent}d[a]=c}return b(c)&&(c=c.call(this.view)),c},l.prototype.clearCache=function(){this.cache={}},l.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=g(a,b)),d},l.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof k?b:new k(b);return this.renderTokens(d,e,c,a)},l.prototype.renderTokens=function(c,d,e,f){function g(a){return k.render(a,d,e)}for(var h,i,j="",k=this,l=0,m=c.length;m>l;++l)switch(h=c[l],h[0]){case"#":if(i=d.lookup(h[1]),!i)continue;if(n(i))for(var o=0,p=i.length;p>o;++o)j+=this.renderTokens(h[4],d.push(i[o]),e,f);else if("object"==typeof i||"string"==typeof i)j+=this.renderTokens(h[4],d.push(i),e,f);else if(b(i)){if("string"!=typeof f)throw new Error("Cannot use higher-order sections without the original template");i=i.call(d.view,f.slice(h[3],h[5]),g),null!=i&&(j+=i)}else j+=this.renderTokens(h[4],d,e,f);break;case"^":i=d.lookup(h[1]),(!i||n(i)&&0===i.length)&&(j+=this.renderTokens(h[4],d,e,f));break;case">":if(!e)continue;i=b(e)?e(h[1]):e[h[1]],null!=i&&(j+=this.renderTokens(this.parse(i),d,e,i));break;case"&":i=d.lookup(h[1]),null!=i&&(j+=i);break;case"name":i=d.lookup(h[1]),null!=i&&(j+=a.escape(i));break;case"text":j+=h[1]}return j},a.name="mustache.js",a.version="0.8.1",a.tags=["{{","}}"];var w=new l;a.clearCache=function(){return w.clearCache()},a.parse=function(a,b){return w.parse(a,b)},a.render=function(a,b,c){return w.render(a,b,c)},a.to_html=function(c,d,e,f){var g=a.render(c,d,e);return b(f)?void f(g):g},a.escape=f,a.Scanner=j,a.Context=k,a.Writer=l}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.page=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a,b){if("function"==typeof a)return c("*",a);if("function"==typeof b)for(var d=new f(a),e=1;e<arguments.length;++e)c.callbacks.push(d.middleware(arguments[e]));else"string"==typeof a?"string"==typeof b?c.redirect(a,b):c.show(a,b):c.start(a)}function d(a){if(!a.handled){var b=m.pathname+m.search;b!==a.canonicalPath&&(c.stop(),a.handled=!1,m.href=a.canonicalPath)}}function e(a,b){"/"===a[0]&&0!==a.indexOf(o)&&(a=o+a);var c=a.indexOf("?");if(this.canonicalPath=a,this.path=a.replace(o,"")||"/",this.title=document.title,this.state=b||{},this.state.path=a,this.querystring=~c?a.slice(c+1):"",this.pathname=~c?a.slice(0,c):a,this.params=[],this.hash="",~this.path.indexOf("#")){var d=this.path.split("#");this.path=d[0],this.hash=d[1]||"",this.querystring=this.querystring.split("#")[0]}}function f(a,b){b=b||{},this.path="*"===a?"(.*)":a,this.method="GET",this.regexp=k(this.path,this.keys=[],b.sensitive,b.strict)}function g(a){if(a.state){var b=a.state.path;c.replace(b,a.state)}}function h(a){if(1==i(a)&&!(a.metaKey||a.ctrlKey||a.shiftKey||a.defaultPrevented)){for(var b=a.target;b&&"A"!=b.nodeName;)b=b.parentNode;if(b&&"A"==b.nodeName){var d=b.getAttribute("href");if(!(b.pathname===m.pathname&&(b.hash||"#"===d)||d&&d.indexOf("mailto:")>-1||b.target||!j(b.href))){var e=b.pathname+b.search+(b.hash||""),f=e+b.hash;e=e.replace(o,""),o&&f===e||(a.preventDefault(),c.show(f))}}}}function i(a){return a=a||window.event,null===a.which?a.button:a.which}function j(a){var b=m.protocol+"//"+m.hostname;return m.port&&(b+=":"+m.port),a&&0===a.indexOf(b)}var k=a("path-to-regexp");b.exports=c;var l,m=window.history.location||window.location,n=!0,o="",p=!1;c.callbacks=[],c.base=function(a){return 0===arguments.length?o:void(o=a)},c.start=function(a){if(a=a||{},!l&&(l=!0,!1===a.dispatch&&(n=!1),!1!==a.popstate&&window.addEventListener("popstate",g,!1),!1!==a.click&&window.addEventListener("click",h,!1),!0===a.hashbang&&(p=!0),n)){var b=p&&0===m.hash.indexOf("#!")?m.hash.substr(2)+m.search:m.pathname+m.search+m.hash;c.replace(b,null,!0,n)}},c.stop=function(){l=!1,removeEventListener("click",h,!1),removeEventListener("popstate",g,!1)},c.show=function(a,b,d){var f=new e(a,b);return!1!==f.handled&&f.pushState(),!1!==d&&c.dispatch(f),f},c.redirect=function(a,b){c(a,function(){setTimeout(function(){c.replace(b)})})},c.replace=function(a,b,d,f){var g=new e(a,b);return g.init=d,g.save(),!1!==f&&c.dispatch(g),g},c.dispatch=function(a){function b(){var f=c.callbacks[e++];return f?void f(a,b):d(a)}var e=0;b()},c.Context=e,e.prototype.pushState=function(){history.pushState(this.state,this.title,p&&"/"!==this.canonicalPath?"#!"+this.canonicalPath:this.canonicalPath)},e.prototype.save=function(){history.replaceState(this.state,this.title,p&&"/"!==this.canonicalPath?"#!"+this.canonicalPath:this.canonicalPath)},c.Route=f,f.prototype.middleware=function(a){var b=this;return function(c,d){return b.match(c.path,c.params)?a(c,d):void d()}},f.prototype.match=function(a,b){var c=this.keys,d=a.indexOf("?"),e=~d?a.slice(0,d):a,f=this.regexp.exec(decodeURIComponent(e));if(!f)return!1;for(var g=1,h=f.length;h>g;++g){var i=c[g-1],j="string"==typeof f[g]?decodeURIComponent(f[g]):f[g];i?b[i.name]=void 0!==b[i.name]?b[i.name]:j:b.push(j)}return!0},c.sameOrigin=j},{"path-to-regexp":2}],2:[function(a,b){function c(a){return a.replace(/([=!:$\/()])/g,"\\$1")}function d(a,b,g){b&&!Array.isArray(b)&&(g=b,b=null),b=b||[],g=g||{};var h=g.strict,i=g.end!==!1,j=g.sensitive?"":"i",k=0;if(a instanceof RegExp){var l=a.source.match(/\((?!\?)/g)||[];return b.push.apply(b,l.map(function(a,b){return{name:b,delimiter:null,optional:!1,repeat:!1}})),f(a,b)}if(Array.isArray(a))return a=a.map(function(a){return d(a,b,g).source}),f(new RegExp("(?:"+a.join("|")+")",j),b);a=a.replace(e,function(a,d,e,f,g,h,i,j){if(d)return d;if(j)return"\\"+j;var l="+"===i||"*"===i,m="?"===i||"*"===i;return b.push({name:f||k++,delimiter:e||"/",optional:m,repeat:l}),e=e?"\\"+e:"",g=c(g||h||"[^"+(e||"\\/")+"]+?"),l&&(g=g+"(?:"+e+g+")*"),m?"(?:"+e+"("+g+"))?":e+"("+g+")"});var m="/"===a[a.length-1];return h||(a=(m?a.slice(0,-2):a)+"(?:\\/(?=$))?"),i||(a+=h&&m?"":"(?=\\/|$)"),f(new RegExp("^"+a+(i?"$":""),j),b)}b.exports=d;var e=new RegExp(["(\\\\.)","([\\/.])?(?:\\:(\\w+)(?:\\(((?:\\\\.|[^)])*)\\))?|\\(((?:\\\\.|[^)])*)\\))([+*?])?","([.+*?=^!:${}()[\\]|\\/])"].join("|"),"g"),f=function(a,b){return a.keys=b,a}},{}]},{},[1])(1)}),function(a){"use strict";function b(a,b){var c=-1!==a.indexOf("data")?"json":"html";if(h.cache[a])b(h.cache[a]);else{a=a+"."+c;var d=new XMLHttpRequest;d.open("GET",a,!0),d.onload=function(){if(!(d.status>=200&&d.status<400))throw"Server error!";var e="json"===c?JSON.parse(d.responseText):d.responseText;h.cache[a]=e,b(e)},d.onerror=function(){throw"Connection error!"},d.send()}}function c(a){var c=[];c.push(a.title),e(a.json)?b(a.partial,function(a){h["yield"].innerHTML=a}):b(a.partial,function(g){b(a.json,function(b){b.time=function(){var b=a.dateFormat||"";return f(this[h.dateField],b)},h["yield"].innerHTML=Mustache.render(g,b),e(a.titleJson)||(c.push(b[a.titleJson]),d(c)),e(a.success)||a.success(b)})}),d(c)}function d(b){b=b.filter(function(a){return void 0!==a}),b.length&&b[0]!==h.title&&b.unshift(h.title),a.title=b.length?b.join(" | "):h.title}function e(a){return"undefined"==typeof a}function f(a,b){var c=new Date(a),d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e=d[c.getMonth()],f=c.getDate(),g=c.getFullYear(),h=c.getHours()+1,i=h>12?h-12:h,j=c.getMinutes()+1,k=h>=12?"p":"a";return"my"===b?e+" "+g:"mdy"===b?e+" "+f+", "+g:e+" "+f+", "+g+" @ "+i+":"+j+k}function g(){h.navToggle.addEventListener("click",function(){this.parentNode.classList.toggle("open-nav")});for(var b=a.querySelectorAll(".m-nav li a"),c=function(){var a=h.navToggle;a.onclick?a.onclick():a.click&&a.click()},d=0,e=b.length;e>d;d++)b[d].addEventListener("click",c)}var h={cache:{},title:"The Moxie Blog","yield":a.querySelectorAll("#js-yield")[0],navToggle:a.querySelectorAll("#js-nav-toggle")[0],dateField:"created_at"},i=function(){page("/",j.index),page("/about",j.about),page("/guestbook",j.guestbook),page("/moxietv",j.moxietv.index),page("/moxietv/:id",j.moxietv.entry),page("/phlog",j.phlog.index),page("/phlog/:id",j.phlog.entry),page("/archive",j.blog.archive),page("/archive/:year",j.blog.archive),page("/post/:id",j.blog.entry),page("*",j.notFound),page({hashbang:!0})},j={index:function(){c({partial:"partials/index"})},guestbook:function(){c({partial:"partials/guestbook",json:"data/guestbook",title:"Guestbook"})},about:function(){c({partial:"partials/about",title:"About the Moxie Blog"})},phlog:{index:function(){c({partial:"partials/phlog/index",json:"data/phlogs/index",title:"Phlog"})},entry:function(a){c({partial:"partials/phlog/entry",json:"data/phlogs/"+a.params.id,title:"Phlog",titleJson:"title"})}},moxietv:{index:function(){c({partial:"partials/moxietv/index",json:"data/moxietv/index",title:"Moxie TV",dateFormat:"mdy"})},entry:function(a){c({partial:"partials/moxietv/entry",json:"data/moxietv/"+a.params.id,title:"Moxie TV",dateFormat:"mdy",titleJson:"title"})}},blog:{archive:function(a){var b=parseInt(a.params.year)||2004;d(["Archive"]),k(b)},entry:function(a){c({partial:"partials/blog/entry",json:"data/posts/"+a.params.id,titleJson:"title"})}},notFound:function(){c({partial:"partials/404",title:"Not found"})}},k=function(a){var c={months:[]};b("data/archive/year/"+a,function(d){for(var e in d){var g=parseInt(e)-1;if(d[e].length){for(var i=new Date(a,g),j=0,k=0,l=d[e].length;l>k;k++)j+=d[e][k].comments;var m={date:f(i,"my"),count:d[e].length,comments:j,posts:d[e]};c.months.push(m)}}b("partials/blog/archive",function(a){h["yield"].innerHTML=Mustache.render(a,c)})})};return a.addEventListener("DOMContentLoaded",function(){g()}),{router:i}}(document).router();
//# sourceMappingURL=app.map